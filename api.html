<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The fastFM API reference &mdash; fastFM 0.2.5 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="fastFM 0.2.5 documentation" href="index.html" />
    <link rel="prev" title="Guide" href="guide.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>fastFM 0.2.5 documentation</span></a></h1>
        <h2 class="heading"><span>The fastFM API reference</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="guide.html">Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="the-fastfm-api-reference">
<h1>The fastFM API reference<a class="headerlink" href="#the-fastfm-api-reference" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-fastFM.mcmc">
<span id="the-mcmc-module"></span><h2>The MCMC module<a class="headerlink" href="#module-fastFM.mcmc" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fastFM.mcmc.FMClassification">
<em class="property">class </em><code class="descclassname">fastFM.mcmc.</code><code class="descname">FMClassification</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>copy_X=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/mcmc.html#FMClassification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.mcmc.FMClassification" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Classification with a MCMC solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of samples for the MCMC sampler, number or iterations over
the training set for ALS and number of steps for SGD.</li>
<li><strong>init_stdev</strong> (<em>float, optional</em>) &#8211; Sets the stdev  for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.w0_">
<code class="descname">w0_</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.w0_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>bias term</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.w_">
<code class="descname">w_</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.w_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float | array, shape = (n_features)</em></p>
<p>Coefficients for linear combination.</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.V_">
<code class="descname">V_</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.V_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float | array, shape = (rank_pair, n_features)</em></p>
<p>Coefficients of second order factor matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMClassification.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMClassification.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMClassification.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.mcmc.FMClassification.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMClassification.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.mcmc.FMClassification.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.fit_predict">
<code class="descname">fit_predict</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em>, <em>X_test</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/mcmc.html#FMClassification.fit_predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.mcmc.FMClassification.fit_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return average class probabilities of posterior estimates of the
test samples.
Use only with MCMC!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X_train</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y_train</strong> (<em>array, shape (n_samples)</em>) &#8211; the targets have to be encodes as {-1, 1}.</li>
<li><strong>X_test</strong> (<em>scipy.sparse.csc_matrix, (n_test_samples, n_features)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y_pred</strong> &#8211;
Returns predicted class labels.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array, shape (n_test_samples)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.fit_predict_proba">
<code class="descname">fit_predict_proba</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em>, <em>X_test</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/mcmc.html#FMClassification.fit_predict_proba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.mcmc.FMClassification.fit_predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Return average class probabilities of posterior estimates of the
test samples.
Use only with MCMC!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X_train</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y_train</strong> (<em>array, shape (n_samples)</em>) &#8211; the targets have to be encodes as {-1, 1}.</li>
<li><strong>X_test</strong> (<em>scipy.sparse.csc_matrix, (n_test_samples, n_features)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>y_pred</strong> &#8211;
Returns probability estimates for the class with lowest
classification label.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array, shape (n_test_samples)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMClassification.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMClassification.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>T</strong> (<em>array, shape (n_samples)</em>) &#8211; The labels are returned for classification.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMClassification.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMClassification.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fastFM.mcmc.FMRegression">
<em class="property">class </em><code class="descclassname">fastFM.mcmc.</code><code class="descname">FMRegression</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>copy_X=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/mcmc.html#FMRegression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.mcmc.FMRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Regression with a MCMC solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of samples for the MCMC sampler, number or iterations over
the training set for ALS and number of steps for SGD.</li>
<li><strong>init_stdev</strong> (<em>float, optional</em>) &#8211; Sets the stdev  for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.w0_">
<code class="descname">w0_</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.w0_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float</em></p>
<p>bias term</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.w_">
<code class="descname">w_</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.w_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float | array, shape = (n_features)</em></p>
<p>Coefficients for linear combination.</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.V_">
<code class="descname">V_</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.V_" title="Permalink to this definition">¶</a></dt>
<dd><p><em>float | array, shape = (rank_pair, n_features)</em></p>
<p>Coefficients of second order factor matrix.</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMRegression.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMRegression.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMRegression.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.mcmc.FMRegression.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.mcmc.FMRegression.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.mcmc.FMRegression.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.fit_predict">
<code class="descname">fit_predict</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em>, <em>X_test</em>, <em>n_more_iter=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/mcmc.html#FMRegression.fit_predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.mcmc.FMRegression.fit_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return average of posterior estimates of the test samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X_train</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y_train</strong> (<em>array, shape (n_samples)</em>) &#8211; </li>
<li><strong>X_test</strong> (<em>scipy.sparse.csc_matrix, (n_test_samples, n_features)</em>) &#8211; </li>
<li><strong>n_more_iter</strong> (<em>int</em>) &#8211; Number of iterations to continue from the current Coefficients.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>T</strong></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array, shape (n_test_samples)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMRegression.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMRegression.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>T</strong> (<em>array, shape (n_samples)</em>) &#8211; The labels are returned for classification.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.mcmc.FMRegression.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.mcmc.FMRegression.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fastFM.als">
<span id="the-als-module"></span><h2>The ALS module<a class="headerlink" href="#module-fastFM.als" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fastFM.als.FMClassification">
<em class="property">class </em><code class="descclassname">fastFM.als.</code><code class="descname">FMClassification</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>l2_reg_w=0.1</em>, <em>l2_reg_V=0.1</em>, <em>l2_reg=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/als.html#FMClassification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.als.FMClassification" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Classification trained with a ALS
(coordinate descent)
solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of samples for the MCMC sampler, number or iterations over
the training set for ALS and number of steps for SGD.</li>
<li><strong>init_stdev</strong> (<em>float, optional</em>) &#8211; Sets the stdev  for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
<li><strong>l2_reg_w</strong> (<em>float</em>) &#8211; L2 penalty weight for pairwise coefficients.</li>
<li><strong>l2_reg_V</strong> (<em>float</em>) &#8211; L2 penalty weight for linear coefficients.</li>
<li><strong>l2_reg</strong> (<em>float</em>) &#8211; L2 penalty weight for all coefficients (default=0).</li>
<li><strong>Attributes</strong> &#8211; </li>
<li><strong>---------</strong> &#8211; </li>
<li><strong>w0</strong> (<em>float</em>) &#8211; bias term</li>
<li><strong>w</strong> (<em>float | array, shape = (n_features)</em>) &#8211; Coefficients for linear combination.</li>
<li><strong>V</strong> (<em>float | array, shape = (rank_pair, n_features)</em>) &#8211; Coefficients of second order factor matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.als.FMClassification.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.als.FMClassification.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMClassification.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.als.FMClassification.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMClassification.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.als.FMClassification.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMClassification.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.als.FMClassification.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.als.FMClassification.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMClassification.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.als.FMClassification.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/als.html#FMClassification.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.als.FMClassification.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y</strong> (<em>float | ndarray, shape = (n_samples, )</em>) &#8211; the targets have to be encodes as {-1, 1}.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>y</strong> (<em>array, shape (n_samples)</em>) &#8211; Class labels</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.predict_proba">
<code class="descname">predict_proba</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Return probabilities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>y</strong> (<em>array, shape (n_samples)</em>) &#8211; Class Probability for the class with smaller label.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>sample_weight=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean accuracy on the given test data and labels.</p>
<p>In multi-label classification, this is the subset accuracy
which is a harsh metric since you require for each sample that
each label set be correctly predicted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>array-like, shape = (n_samples, n_features)</em>) &#8211; Test samples.</li>
<li><strong>y</strong> (<em>array-like, shape = (n_samples) or (n_samples, n_outputs)</em>) &#8211; True labels for X.</li>
<li><strong>sample_weight</strong> (<em>array-like, shape = [n_samples], optional</em>) &#8211; Sample weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>score</strong> &#8211;
Mean accuracy of self.predict(X) wrt. y.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMClassification.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMClassification.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fastFM.als.FMRegression">
<em class="property">class </em><code class="descclassname">fastFM.als.</code><code class="descname">FMRegression</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>l2_reg_w=0.1</em>, <em>l2_reg_V=0.1</em>, <em>l2_reg=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/als.html#FMRegression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.als.FMRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Regression trained with a als (coordinate descent)
solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of samples for the MCMC sampler, number or iterations over
the training set for ALS and number of steps for SGD.</li>
<li><strong>init_stdev</strong> (<em>float, optional</em>) &#8211; Sets the stdev for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
<li><strong>l2_reg_w</strong> (<em>float</em>) &#8211; L2 penalty weight for pairwise coefficients.</li>
<li><strong>l2_reg_V</strong> (<em>float</em>) &#8211; L2 penalty weight for linear coefficients.</li>
<li><strong>l2_reg</strong> (<em>float</em>) &#8211; L2 penalty weight for all coefficients (default=0).</li>
<li><strong>Attributes</strong> &#8211; </li>
<li><strong>---------</strong> &#8211; </li>
<li><strong>w0</strong> (<em>float</em>) &#8211; bias term</li>
<li><strong>w</strong> (<em>float | array, shape = (n_features)</em>) &#8211; Coefficients for linear combination.</li>
<li><strong>V</strong> (<em>float | array, shape = (rank_pair, n_features)</em>) &#8211; Coefficients of second order factor matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.als.FMRegression.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.als.FMRegression.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMRegression.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.als.FMRegression.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMRegression.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.als.FMRegression.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMRegression.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.als.FMRegression.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.als.FMRegression.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.als.FMRegression.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.als.FMRegression.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X_train</em>, <em>y_train</em>, <em>n_more_iter=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/als.html#FMRegression.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.als.FMRegression.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y</strong> (<em>float | ndarray, shape = (n_samples, )</em>) &#8211; </li>
<li><strong>n_more_iter</strong> (<em>int</em>) &#8211; Number of iterations to continue from the current Coefficients.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>T</strong> (<em>array, shape (n_samples)</em>) &#8211; The labels are returned for classification.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>sample_weight=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coefficient of determination R^2 of the prediction.</p>
<p>The coefficient R^2 is defined as (1 - u/v), where u is the regression
sum of squares ((y_true - y_pred) ** 2).sum() and v is the residual
sum of squares ((y_true - y_true.mean()) ** 2).sum().
Best possible score is 1.0 and it can be negative (because the
model can be arbitrarily worse). A constant model that always
predicts the expected value of y, disregarding the input features,
would get a R^2 score of 0.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>array-like, shape = (n_samples, n_features)</em>) &#8211; Test samples.</li>
<li><strong>y</strong> (<em>array-like, shape = (n_samples) or (n_samples, n_outputs)</em>) &#8211; True values for X.</li>
<li><strong>sample_weight</strong> (<em>array-like, shape = [n_samples], optional</em>) &#8211; Sample weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>score</strong> &#8211;
R^2 of self.predict(X) wrt. y.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.als.FMRegression.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.als.FMRegression.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fastFM.sgd">
<span id="the-sgd-module"></span><h2>The SGD module<a class="headerlink" href="#module-fastFM.sgd" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fastFM.sgd.FMClassification">
<em class="property">class </em><code class="descclassname">fastFM.sgd.</code><code class="descname">FMClassification</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>l2_reg_w=0</em>, <em>l2_reg_V=0</em>, <em>l2_reg=None</em>, <em>step_size=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/sgd.html#FMClassification"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.sgd.FMClassification" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Classification trained with a stochastic gradient
descent solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of interations of individual samples .</li>
<li><strong>init_std</strong> (<em>float, optional</em>) &#8211; Sets the stdev for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
<li><strong>l2_reg_w</strong> (<em>float</em>) &#8211; L2 penalty weight for pairwise coefficients.</li>
<li><strong>l2_reg_V</strong> (<em>float</em>) &#8211; L2 penalty weight for linear coefficients.</li>
<li><strong>l2_reg</strong> (<em>float</em>) &#8211; L2 penalty weight for all coefficients (default=0).</li>
<li><strong>step_size</strong> (<em>float</em>) &#8211; Stepsize for the SGD solver, the solver uses a fixed step size and
might require a tunning of the number of iterations <cite>n_iter</cite>.</li>
<li><strong>Attributes</strong> &#8211; </li>
<li><strong>---------</strong> &#8211; </li>
<li><strong>w0</strong> (<em>float</em>) &#8211; bias term</li>
<li><strong>w</strong> (<em>float | array, shape = (n_features)</em>) &#8211; Coefficients for linear combination.</li>
<li><strong>V</strong> (<em>float | array, shape = (rank_pair, n_features)</em>) &#8211; Coefficients of second order factor matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.sgd.FMClassification.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.sgd.FMClassification.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMClassification.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.sgd.FMClassification.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMClassification.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.sgd.FMClassification.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMClassification.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.sgd.FMClassification.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.sgd.FMClassification.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMClassification.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.sgd.FMClassification.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/sgd.html#FMClassification.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.sgd.FMClassification.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y</strong> (<em>float | ndarray, shape = (n_samples, )</em>) &#8211; the targets have to be encodes as {-1, 1}.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>y</strong> (<em>array, shape (n_samples)</em>) &#8211; Class labels</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.predict_proba">
<code class="descname">predict_proba</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Return probabilities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>y</strong> (<em>array, shape (n_samples)</em>) &#8211; Class Probability for the class with smaller label.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>sample_weight=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean accuracy on the given test data and labels.</p>
<p>In multi-label classification, this is the subset accuracy
which is a harsh metric since you require for each sample that
each label set be correctly predicted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>array-like, shape = (n_samples, n_features)</em>) &#8211; Test samples.</li>
<li><strong>y</strong> (<em>array-like, shape = (n_samples) or (n_samples, n_outputs)</em>) &#8211; True labels for X.</li>
<li><strong>sample_weight</strong> (<em>array-like, shape = [n_samples], optional</em>) &#8211; Sample weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>score</strong> &#8211;
Mean accuracy of self.predict(X) wrt. y.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMClassification.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMClassification.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="fastFM.sgd.FMRegression">
<em class="property">class </em><code class="descclassname">fastFM.sgd.</code><code class="descname">FMRegression</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>l2_reg_w=0.1</em>, <em>l2_reg_V=0.1</em>, <em>l2_reg=0</em>, <em>step_size=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/sgd.html#FMRegression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.sgd.FMRegression" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Regression trained with a stochastic gradient
descent solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of interations of individual samples .</li>
<li><strong>init_stdev</strong> (<em>float, optional</em>) &#8211; Sets the stdev for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
<li><strong>l2_reg_w</strong> (<em>float</em>) &#8211; L2 penalty weight for pairwise coefficients.</li>
<li><strong>l2_reg_V</strong> (<em>float</em>) &#8211; L2 penalty weight for linear coefficients.</li>
<li><strong>l2_reg</strong> (<em>float</em>) &#8211; L2 penalty weight for all coefficients (default=0).</li>
<li><strong>step_size</strong> (<em>float</em>) &#8211; Stepsize for the SGD solver, the solver uses a fixed step size and
might require a tunning of the number of iterations <cite>n_iter</cite>.</li>
<li><strong>Attributes</strong> &#8211; </li>
<li><strong>---------</strong> &#8211; </li>
<li><strong>w0</strong> (<em>float</em>) &#8211; bias term</li>
<li><strong>w</strong> (<em>float | array, shape = (n_features)</em>) &#8211; Coefficients for linear combination.</li>
<li><strong>V</strong> (<em>float | array, shape = (rank_pair, n_features)</em>) &#8211; Coefficients of second order factor matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.sgd.FMRegression.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.sgd.FMRegression.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMRegression.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.sgd.FMRegression.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMRegression.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.sgd.FMRegression.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMRegression.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.sgd.FMRegression.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.sgd.FMRegression.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.sgd.FMRegression.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.sgd.FMRegression.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/sgd.html#FMRegression.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.sgd.FMRegression.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y</strong> (<em>float | ndarray, shape = (n_samples, )</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>T</strong> (<em>array, shape (n_samples)</em>) &#8211; The labels are returned for classification.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.score">
<code class="descname">score</code><span class="sig-paren">(</span><em>X</em>, <em>y</em>, <em>sample_weight=None</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.score" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coefficient of determination R^2 of the prediction.</p>
<p>The coefficient R^2 is defined as (1 - u/v), where u is the regression
sum of squares ((y_true - y_pred) ** 2).sum() and v is the residual
sum of squares ((y_true - y_true.mean()) ** 2).sum().
Best possible score is 1.0 and it can be negative (because the
model can be arbitrarily worse). A constant model that always
predicts the expected value of y, disregarding the input features,
would get a R^2 score of 0.0.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> (<em>array-like, shape = (n_samples, n_features)</em>) &#8211; Test samples.</li>
<li><strong>y</strong> (<em>array-like, shape = (n_samples) or (n_samples, n_outputs)</em>) &#8211; True values for X.</li>
<li><strong>sample_weight</strong> (<em>array-like, shape = [n_samples], optional</em>) &#8211; Sample weights.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>score</strong> &#8211;
R^2 of self.predict(X) wrt. y.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.sgd.FMRegression.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.sgd.FMRegression.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-fastFM.bpr">
<span id="the-ranking-module"></span><h2>The Ranking module<a class="headerlink" href="#module-fastFM.bpr" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="fastFM.bpr.FMRecommender">
<em class="property">class </em><code class="descclassname">fastFM.bpr.</code><code class="descname">FMRecommender</code><span class="sig-paren">(</span><em>n_iter=100</em>, <em>init_stdev=0.1</em>, <em>rank=8</em>, <em>random_state=123</em>, <em>l2_reg_w=0.1</em>, <em>l2_reg_V=0.1</em>, <em>l2_reg=0</em>, <em>step_size=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/bpr.html#FMRecommender"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.bpr.FMRecommender" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorization Machine Recommender with pairwise (BPR) loss solver.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_iter</strong> (<em>int, optional</em>) &#8211; The number of interations of individual samples .</li>
<li><strong>init_stdev</strong> (<em>float, optional</em>) &#8211; Sets the stdev for the initialization of the parameter</li>
<li><strong>random_state</strong> (<em>int, optional</em>) &#8211; The seed of the pseudo random number generator that
initializes the parameters and mcmc chain.</li>
<li><strong>rank</strong> (<em>int</em>) &#8211; The rank of the factorization used for the second order interactions.</li>
<li><strong>l2_reg_w</strong> (<em>float</em>) &#8211; L2 penalty weight for pairwise coefficients.</li>
<li><strong>l2_reg_V</strong> (<em>float</em>) &#8211; L2 penalty weight for linear coefficients.</li>
<li><strong>l2_reg</strong> (<em>float</em>) &#8211; L2 penalty weight for all coefficients (default=0).</li>
<li><strong>step_size</strong> (<em>float</em>) &#8211; Stepsize for the SGD solver, the solver uses a fixed step size and
might require a tunning of the number of iterations <cite>n_iter</cite>.</li>
<li><strong>Attributes</strong> &#8211; </li>
<li><strong>---------</strong> &#8211; </li>
<li><strong>w0</strong> (<em>float</em>) &#8211; bias term</li>
<li><strong>w</strong> (<em>float | array, shape = (n_features)</em>) &#8211; Coefficients for linear combination.</li>
<li><strong>V</strong> (<em>float | array, shape = (rank_pair, n_features)</em>) &#8211; Coefficients of second order factor matrix.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="fastFM.bpr.FMRecommender.__delattr__">
<code class="descname">__delattr__</code><a class="headerlink" href="#fastFM.bpr.FMRecommender.__delattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__delattr__(&#8216;name&#8217;) &lt;==&gt; del x.name</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.__format__">
<code class="descname">__format__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.bpr.FMRecommender.__format__" title="Permalink to this definition">¶</a></dt>
<dd><p>default object formatter</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.bpr.FMRecommender.__getattribute__">
<code class="descname">__getattribute__</code><a class="headerlink" href="#fastFM.bpr.FMRecommender.__getattribute__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__getattribute__(&#8216;name&#8217;) &lt;==&gt; x.name</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.bpr.FMRecommender.__hash__">
<code class="descname">__hash__</code><a class="headerlink" href="#fastFM.bpr.FMRecommender.__hash__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.__reduce__">
<code class="descname">__reduce__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.bpr.FMRecommender.__reduce__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.__reduce_ex__">
<code class="descname">__reduce_ex__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.bpr.FMRecommender.__reduce_ex__" title="Permalink to this definition">¶</a></dt>
<dd><p>helper for pickle</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.bpr.FMRecommender.__setattr__">
<code class="descname">__setattr__</code><a class="headerlink" href="#fastFM.bpr.FMRecommender.__setattr__" title="Permalink to this definition">¶</a></dt>
<dd><p>x.__setattr__(&#8216;name&#8217;, value) &lt;==&gt; x.name = value</p>
</dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.__sizeof__">
<code class="descname">__sizeof__</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &rarr; int<a class="headerlink" href="#fastFM.bpr.FMRecommender.__sizeof__" title="Permalink to this definition">¶</a></dt>
<dd><p>size of object in memory, in bytes</p>
</dd></dl>

<dl class="attribute">
<dt id="fastFM.bpr.FMRecommender.__str__">
<code class="descname">__str__</code><a class="headerlink" href="#fastFM.bpr.FMRecommender.__str__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.fit">
<code class="descname">fit</code><span class="sig-paren">(</span><em>X</em>, <em>pairs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/fastFM/bpr.html#FMRecommender.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fastFM.bpr.FMRecommender.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified loss.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>y</strong> (<em>float | ndarray, shape = (n_compares, 2)</em>) &#8211; Each row <cite>i</cite> defines a pair of samples such that
the first returns a high value then the second
FM(X[i,0]) &gt; FM(X[i, 1]).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.get_params">
<code class="descname">get_params</code><span class="sig-paren">(</span><em>deep=True</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.bpr.FMRecommender.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get parameters for this estimator.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>deep</strong> (<em>boolean, optional</em>) &#8211; If True, will return the parameters for this estimator and
contained subobjects that are estimators.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>params</strong> &#8211;
Parameter names mapped to their values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">mapping of string to any</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>X_test</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.bpr.FMRecommender.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return predictions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> (<em>scipy.sparse.csc_matrix, (n_samples, n_features)</em>) &#8211; </li>
<li><strong>Returns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>T</strong> (<em>array, shape (n_samples)</em>) &#8211; The labels are returned for classification.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="fastFM.bpr.FMRecommender.set_params">
<code class="descname">set_params</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="headerlink" href="#fastFM.bpr.FMRecommender.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The former have parameters of the form
<code class="docutils literal"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it&#8217;s possible to update each
component of a nested object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="guide.html">Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Immanuel Bayer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>